<!DOCTYPE html>
<!--
	Interphase by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html lang="en">
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.1/handlebars.min.js"></script>
<head>
  <meta charset="UTF-8">
  <title>Spotify Playlist Extender</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="description" content="" />
  <meta name="keywords" content="" />
  <!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
  <script src="js/jquery.min.js"></script>
  <script src="js/skel.min.js"></script>
  <script src="js/skel-layers.min.js"></script>
  <script src="js/init.js"></script>
  <noscript>
     <link rel="stylesheet" href="css/skel.css" />
     <link rel="stylesheet" href="css/style.css" />
     <link rel="stylesheet" href="css/style-xlarge.css" />
 </noscript>
 <!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
</head>

<div ng-app="myApp" ng-controller="myCtrl">

    <div ng-show="start">
        <div class="container">
          <div id="login">
            <h1>Welcome! Please log in</h1>
            <button href = "/login" ng-click="toggleStart()" class="btn btn-primary">Login with Spotify</button>

            <!-- <a href="/login" class="btn btn-primary" ng-click="toggleStart()">Log in with Spotify</a> -->
          </div>
        <!-- <div id="loggedin">
            <div id="user-profile">
            </div>
            <div id="oauth">
            </div>
            <button class="btn btn-default" id="obtain-new-token">Obtain new token using the refresh token</button>
            <a href="/login" class="btn btn-primary">Log out</a>
        </div> -->


        </div>
    </div>

<div ng-hide="start">
  <script src="js/controllers/searchController.js"></script>
   <body class="landing">

   <div id="loggedin">
    <div id="user-profile">
    </div>
    <div id="oauth">
    </div>
    <!-- <button class="btn btn-default" id="obtain-new-token">Obtain new token using the refresh token</button> -->
    <a href="/login" class="btn btn-primary">Log out</a>
    </div>


    <!-- Header -->
    <header id="header">
        <h1><a href="index.html">Spotify Enhancer</a></h1>
        <nav id="nav">
           <ul>
              <li><a href="index.html">Home</a></li>
              <li><a href="generic.html">Generic</a></li>
              <li><a href="elements.html">Elements</a></li>
          </ul>
      </nav>
  </header>

  <!-- Banner -->
  <!-- <div ng-app="myApp" ng-controller="myCtrl"> -->
  <section id="banner">
    <h2>Spotify Enhancer</h2>
    <p>Discover new music | Expand your personal library</p>
    <ul class="actions">
        <li>
            <input type="text" name="search" placeholder="Search for a song/artist" ng-model="userInput">
        </li>
        <li>
          <button ng-click="performSearch()" class="button small">Search</button>
      </li>
  </ul>

</section>

<div class="jsonResponse">
    <!-- {{userInput}} -->
</div>
</div>

<!-- One -->
<section id="one" class="wrapper style1 align-center">
    <div class="container">
       <header>
          <h2>Consectetur adipisicing elit</h2>
          <p>Lorem ipsum dolor sit amet adipisicing elit. Delectus consequatur sed tempus.</p>
      </header>
      <div class="row 200%">
          <section class="4u 12u$(small)">
             <i class="icon big rounded fa-clock-o"></i>
             <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Enim quam consectetur quibusdam magni minus aut modi aliquid.</p>
         </section>
         <section class="4u 12u$(small)">
             <i class="icon big rounded fa-comments"></i>
             <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laudantium ullam consequatur repellat debitis maxime molestiae.</p>
         </section>
         <section class="4u$ 12u$(small)">
             <i class="icon big rounded fa-user"></i>
             <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Atque eaque eveniet, nesciunt molestias. Ipsam, voluptate vero.</p>
         </section>
     </div>
 </div>
</section>

<!-- Footer -->
<footer id="footer">
    <div class="container">
       <div class="row">
          <section class="4u 6u(medium) 12u$(small)">
             <h3>Lorem ipsum</h3>
             <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Assumenda, cumque!</p>
             <ul class="alt">
                <li><a href="#">Lorem ipsum dolor sit amet.</a></li>
                <li><a href="#">Quod adipisci perferendis et itaque.</a></li>
                <li><a href="#">Itaque eveniet ullam, veritatis reiciendis?</a></li>
                <li><a href="#">Accusantium repellat accusamus a, soluta.</a></li>
            </ul>
        </section>
        <section class="4u 6u$(medium) 12u$(small)">
         <h3>Nostrum, repellat!</h3>
         <p>Tenetur voluptate exercitationem eius tempora! Obcaecati suscipit, soluta earum blanditiis.</p>
         <ul class="alt">
            <li><a href="#">Lorem ipsum dolor sit amet.</a></li>
            <li><a href="#">Id inventore, qui necessitatibus sunt.</a></li>
            <li><a href="#">Deleniti eum odit nostrum eveniet.</a></li>
            <li><a href="#">Illum consectetur quibusdam eos corporis.</a></li>
        </ul>
    </section>
    <section class="4u$ 12u$(medium) 12u$(small)">
     <h3>Contact Us</h3>
     <ul class="icons">
        <li><a href="#" class="icon rounded fa-twitter"><span class="label">Twitter</span></a></li>
        <li><a href="#" class="icon rounded fa-facebook"><span class="label">Facebook</span></a></li>
        <li><a href="#" class="icon rounded fa-pinterest"><span class="label">Pinterest</span></a></li>
        <li><a href="#" class="icon rounded fa-google-plus"><span class="label">Google+</span></a></li>
        <li><a href="#" class="icon rounded fa-linkedin"><span class="label">LinkedIn</span></a></li>
    </ul>
    <ul class="tabular">
        <li>
           <h3>Address</h3>
           1234 Somewhere Road<br>
           Nashville, TN 00000
       </li>
       <li>
           <h3>Mail</h3>
           <a href="#">someone@untitled.tld</a>
       </li>
       <li>
           <h3>Phone</h3>
           (000) 000-0000
       </li>
   </ul>
</section>
</div>
<ul class="copyright">
  <li>&copy; Untitled. All rights reserved.</li>
  <li>Design: <a href="http://templated.co">TEMPLATED</a></li>
  <li>Images: <a href="http://unsplash.com">Unsplash</a></li>
</ul>
</div>
</footer>

<script id="user-profile-template" type="text/x-handlebars-template">
      <h1>Logged in as {{display_name}}</h1>
      <div class="media">
        <div class="pull-left">
          <img class="media-object" width="150" src="{{images.0.url}}" />
        </div>
        <div class="media-body">
          <dl class="dl-horizontal">
            <!-- <dt>Display name</dt><dd class="clearfix">{{display_name}}</dd> -->
            <!-- <dt>Id</dt><dd>{{id}}</dd> -->
            <!-- <dt>Email</dt><dd>{{email}}</dd> -->
            <!-- <dt>Spotify URI</dt><dd><a href="{{external_urls.spotify}}">{{external_urls.spotify}}</a></dd> -->
            <!-- <dt>Link</dt><dd><a href="{{href}}">{{href}}</a></dd> -->
            <!-- <dt>Profile Image</dt><dd class="clearfix"><a href="{{images.0.url}}">{{images.0.url}}</a></dd>
            <dt>Country</dt><dd>{{country}}</dd> -->
          </dl>
        </div>
      </div>
    </script>

<script id="oauth-template" type="text/x-handlebars-template">
      <!-- <h2>oAuth info</h2>
      <dl class="dl-horizontal">
        <dt>Access token</dt><dd class="text-overflow">{{access_token}}</dd>
        <dt>Refresh token</dt><dd class="text-overflow">{{refresh_token}}></dd>
      </dl> -->
    </script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.1/handlebars.min.js"></script>

    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>

    <script>
      (function() {

        /**
         * Obtains parameters from the hash of the URL
         * @return Object
         */
        function getHashParams() {
          var hashParams = {};
          var e, r = /([^&;=]+)=?([^&;]*)/g,
              q = window.location.hash.substring(1);
          while ( e = r.exec(q)) {
             hashParams[e[1]] = decodeURIComponent(e[2]);
          }
          return hashParams;
        }

        var userProfileSource = document.getElementById('user-profile-template').innerHTML,
            userProfileTemplate = Handlebars.compile(userProfileSource),
            userProfilePlaceholder = document.getElementById('user-profile');

        var oauthSource = document.getElementById('oauth-template').innerHTML,
            oauthTemplate = Handlebars.compile(oauthSource),
            oauthPlaceholder = document.getElementById('oauth');

        var params = getHashParams();

        var access_token = params.access_token,
            refresh_token = params.refresh_token,
            error = params.error;

        if (error) {
          alert('There was an error during the authentication');
        } else {
          if (access_token) {
            // render oauth info
            oauthPlaceholder.innerHTML = oauthTemplate({
              access_token: access_token,
              refresh_token: refresh_token
            });

            $.ajax({
                url: 'https://api.spotify.com/v1/me',
                headers: {
                  'Authorization': 'Bearer ' + access_token
                },
                success: function(response) {
                  userProfilePlaceholder.innerHTML = userProfileTemplate(response);

                  $('#login').hide();
                  $('#loggedin').show();
                }
            });
          } else {
              // render initial screen
              $('#login').show();
              $('#loggedin').hide();
          }

          // document.getElementById('obtain-new-token').addEventListener('click', function() {
          //   $.ajax({
          //     url: '/refresh_token',
          //     data: {
          //       'refresh_token': refresh_token
          //     }
          //   }).done(function(data) {
          //     access_token = data.access_token;
          //     oauthPlaceholder.innerHTML = oauthTemplate({
          //       access_token: access_token,
          //       refresh_token: refresh_token
          //     });
          //   });
          // }, false);
        }
      })();
    </script>
  

</body>
</div>
</div>
</html>