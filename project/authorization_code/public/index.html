<!DOCTYPE html>
<!--
	Interphase by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html lang="en">
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
<script src="//code.angularjs.org/snapshot/angular-animate.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.1/handlebars.min.js"></script>
<head>
  <meta charset="UTF-8">
  <title>Spotify Playlist Extender</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="description" content="" />
  <meta name="keywords" content="" />
  <!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
  <script src="js/jquery.min.js"></script>
  <script src="js/skel.min.js"></script>
  <script src="js/skel-layers.min.js"></script>
  <script src="js/init.js"></script>
  <noscript>
     <link rel="stylesheet" href="css/skel.css" />
     <link rel="stylesheet" href="css/style.css" />
     <link rel="stylesheet" href="css/style-xlarge.css" />
 </noscript>

  <SCRIPT TYPE="text/javascript">
  function popup(mylink, windowname) {
    if (! window.focus)return true;
    var href = 'similartracks.html';
    if (typeof(mylink) == 'string') href='similartracks.html';
    else href='similartracks.html'; 
    window.open(href, windowname, 'width=400,height=200,scrollbars=yes'); 
    return false; 
  }
  </SCRIPT>
 <!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
</head>

<div ng-app="myApp" ng-controller="myCtrl">

<div>
   <script src="js/controllers/searchController.js"></script>
   <body class="landing">

  <div id="loggedin">
    <div id="user-profile">
    </div>
    <!-- <div id="oauth">
    </div> -->
    <!-- <button class="btn btn-default" id="obtain-new-token">Obtain new token using the refresh token</button> -->
      <!-- <a href="/login" class="btn btn-primary">Log out</a> -->
  </div>

    <!-- <div id="oauth"></div> -->


    <!-- Header -->
    <header id="header">
        <h1><a href="index.html">Spotify Enhancer</a></h1>
        <nav id="nav">
          <ul>
              <li><a href="index.html">Home</a></li>
              <li><a href="">About</a></li>
              <li><a href="">Elements</a></li>
              <li><a href="index.html">Log Out</a></li>
          </ul>
        </nav>
    </header>

  <!-- Banner -->
  <!-- <div ng-app="myApp" ng-controller="myCtrl"> -->
  <section id="banner">


    <div>
        <div class="container">
          <div id="login">
            <h1 style="color: white;">Welcome! Please log in</h1>
            <a class="login_button" href = "/login" class="btn btn-primary" ng-click="toggleStart()">Login with Spotify</a>

            <!-- <a href="/login" class="btn btn-primary" ng-click="toggleStart()">Log in with Spotify</a> -->
          </div>
        <!-- <div id="loggedin">
            <div id="user-profile">
            </div>
            <div id="oauth">
            </div>
            <button class="btn btn-default" id="obtain-new-token">Obtain new token using the refresh token</button>
            <a href="/login" class="btn btn-primary">Log out</a>
        </div> -->


        </div>
    </div>


    <h2>Spotify Enhancer</h2>
    <p>Discover new music | Expand your personal library</p>
    <div id="welcomeuser">
    </div>


    <script id="user-profile-template" type="text/x-handlebars-template">
      <h1 style="color:white; margin-top:30px">Welcome, {{display_name}}</h1>
      <!-- <a class="login_button" href = "http://localhost:8888" class="btn btn-primary">Log Out</a> -->
    </script>



    <ul class="actions">
        <li>
            <input type="text" name="search" placeholder="Search for a song/artist" ng-model="userInput">
        </li>
        <li>
          <button ng-click="performSearch()" class="button small">Search</button>
      </li>
    </ul>

</section>

<div class="jsonResponse_artist" ng-repeat="a in artists">
    <!-- {{userInput}} -->
    <div>
    Artist: {{a.name}} <br>
    <a href={{a.uri}}> <img src="../../images/spotify-link.png" width="25px" height="25px"> </a>
    <a target="_blank" href={{a.external_urls.spotify}}> <img src="../../images/browser-link.png" width="25px" height="25px"> </a>
    </div>

</div>

  <div class="jsonResponse_tracks" ng-repeat="t in tracks">
    <div>
      Track: {{t.name}} by {{t.artists[0].name}} <br>
      <a href={{t.uri}}> <img src="../../images/spotify-link.png" width="25px" height="25px"> </a>
      <a target="_blank" href={{t.external_urls.spotify}}> <img src="../../images/browser-link.png" width="25px" height="25px"> </a>
      <form method="link" action="similartracks.html" target="_blank">
        <input type="hidden" value="{{t.name}}" name="track_name">
        <input type="hidden" value="{{t.artists[0].name}}" name="artist_name">
        <input type="image" src="../../images/similar-link.png" alt="submit" width="25px" height="25px">
      </form>
     <!--  <a ng-click="myFunction(); getSimilar(t.name, t.artists[0].name)"> <img src="../../images/similar-link.png" width="25px" height="25px"></a> -->
     <!--  <a href="similartracks.html" ng-click="getSimilar(t.name, t.artists[0].name)" onClick="return popup('similartracks.html', 'notes')"> <img src="../../images/similar-link.png" width="25px" height="25px"> </a>
      -->

      <!-- jackies stuff -->
      
      
    </div>
  </div>


<!-- <script>
// When the user clicks on div, open the popup
function myFunction(id) {
    // var popup = document.getElementById('myPopup' + id);
    // popup.classList.toggle('show');
    console.log("pen15");
    document.getElementsByClassName(similarsong).innerHTML = null;

    document.getElementById(id).innerHTML = "<p>Hello World!</p>"
}
</script> -->



</div>

<!-- One -->
<section id="one" class="wrapper style1 align-center">
    <div class="container">
       <header>
          <h2>What can you do here?</h2>
          <p>Check out these features to effortlessly add new music to your Spotify playlists</p>
      </header>
      <div class="row 200%">
          <section class="4u 12u$(small)">
             <i class="icon big rounded fa-spotify"></i>
             <p>Conveniently access your Spotify playlists by connecting your account to the Spotify Enhancer</p>
         </section>
         <section class="4u 12u$(small)">
             <i class="icon big rounded fa-search"></i>
             <p>Quickly find new music based on songs and artists in your current playlists</p>
         </section>
         <section class="4u$ 12u$(small)">
             <i class="icon big rounded fa-play-circle"></i>
             <p>Listen to your new playlists and easily export your new playlist back to Spotify</p>
         </section>
     </div>
 </div>
</section>

<!-- Footer -->
<footer id="footer">
    <div class="container">
       <div class="row">
          <section class="4u 6u(medium) 12u$(small)">
             <h3>Reviews</h3>
             <p>Check out these reviews of Spotify!</p>
             <ul class="alt">
                <li><a target="_blank" href="http://www.pcmag.com/article2/0,2817,2366868,00.asp">"Spotify is better than ever" - PCMag</a></li>
                <li><a target="_blank" href="https://www.cnet.com/products/spotify/review/">"Spotify is the king of streaming music" - CNET</a></li>
                <li><a target="_blank" href="http://www.techradar.com/reviews/pc-mac/software/utilities/other-software/spotify-526289/review">"Our favourite music streaming service by a mile" - TechRadar</a></li>
                <li><a target="_blank" href="http://www.digitaltrends.com/music/apple-music-vs-spotify/">"The undisputed king of on-demand streaming music" - Digital Trends</a></li>
            </ul>
        </section>
        <section class="4u 6u$(medium) 12u$(small)">
         <h3>Testimonials</h3>
         <p>See what our satisfied customers had to say about Spotify Enhancer</p>
         <ul class="alt">
            <li><a target="_blank" href="https://www.instagram.com/p/BA8V2QXGkewcVA2qdlBBL7YB6iHCI1RxNxRtnE0/?taken-by=ethniclightning">"I've been waiting for this day" - Joseph Cho</a></li>
            <li><a target="_blank" href="https://www.instagram.com/p/BAln2EEGkfgEQJYQPa-kBSYEcugB5XITIZ1YSw0/?taken-by=ethniclightning">"I was impressed" - Joseph Cho</a></li>
            <li><a target="_blank" href="https://www.instagram.com/p/BFkXuSemkffzfvRDMYcGQa7Z9vymkOM_cVAJM00/?taken-by=ethniclightning">"You can't fool me" - Joseph Cho</a></li>
            <li><a target="_blank" href="https://www.instagram.com/p/--d906mkYcNDWr4YPK31s892sJmxpcvVTsHOY0/?taken-by=ethniclightning">"Stokedd" - Joseph Cho</a></li>
        </ul>
    </section>
    <section class="4u$ 12u$(medium) 12u$(small)">
     <h3>Contact Us</h3>
     <ul class="icons">
        <li><a href="#" class="icon rounded fa-twitter"><span class="label">Twitter</span></a></li>
        <li><a href="#" class="icon rounded fa-facebook"><span class="label">Facebook</span></a></li>
        <li><a href="#" class="icon rounded fa-pinterest"><span class="label">Pinterest</span></a></li>
        <li><a href="#" class="icon rounded fa-google-plus"><span class="label">Google+</span></a></li>
        <li><a href="#" class="icon rounded fa-linkedin"><span class="label">LinkedIn</span></a></li>
    </ul>
    <ul class="tabular">
        <li>
           <h3>Address</h3>
           726 Commonwealth Ave<br>
           Boston, MA 02215
       </li>
       <li>
           <h3>Mail</h3>
           <a href="#">info@spotifyenhance.com</a>
       </li>
       <li>
           <h3>Phone</h3>
           (000) 000-0000
       </li>
   </ul>
</section>
</div>
<ul class="copyright">
  <li>&copy; Untitled. All rights reserved.</li>
  <li>Design: <a href="http://templated.co">TEMPLATED</a></li>
  <li>Images: <a href="http://unsplash.com">Unsplash</a></li>
</ul>
</div>
</footer>

<!-- USER PROFILE TEMPLATE HERE PLS -->

<script id="oauth-template" type="text/x-handlebars-template">
      <!-- <h2>oAuth info</h2>
      <dl class="dl-horizontal">
        <dt>Access token</dt><dd class="text-overflow">{{access_token}}</dd>
        <dt>Refresh token</dt><dd class="text-overflow">{{refresh_token}}></dd>
      </dl> -->
    </script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.1/handlebars.min.js"></script>

    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>

    <script>
      (function() {

        /**
         * Obtains parameters from the hash of the URL
         * @return Object
         */
        function getHashParams() {
          var hashParams = {};
          var e, r = /([^&;=]+)=?([^&;]*)/g,
              q = window.location.hash.substring(1);
          while ( e = r.exec(q)) {
             hashParams[e[1]] = decodeURIComponent(e[2]);
          }
          return hashParams;
        }

        var userProfileSource = document.getElementById('user-profile-template').innerHTML,
            userProfileTemplate = Handlebars.compile(userProfileSource),
            userProfilePlaceholder = document.getElementById('welcomeuser');

        var oauthSource = document.getElementById('oauth-template').innerHTML,
            oauthTemplate = Handlebars.compile(oauthSource); //,
            //oauthPlaceholder = document.getElementById('oauth');

        var params = getHashParams();

        var access_token = params.access_token,
            refresh_token = params.refresh_token,
            error = params.error;

        if (error) {
          alert('There was an error during the authentication');
        } else {
          if (access_token) {
            // render oauth info
            // oauthPlaceholder.innerHTML = oauthTemplate({
            //   access_token: access_token,
            //   refresh_token: refresh_token
            // });

            $.ajax({
                url: 'https://api.spotify.com/v1/me',
                headers: {
                  'Authorization': 'Bearer ' + access_token
                },
                success: function(response) {
                  userProfilePlaceholder.innerHTML = userProfileTemplate(response);

                  $('#login').hide();
                  $('#loggedin').show();
                }
            });
          } else {
              // render initial screen
              $('#login').show();
              $('#loggedin').hide();
          }

          // document.getElementById('obtain-new-token').addEventListener('click', function() {
          //   $.ajax({
          //     url: '/refresh_token',
          //     data: {
          //       'refresh_token': refresh_token
          //     }
          //   }).done(function(data) {
          //     access_token = data.access_token;
          //     oauthPlaceholder.innerHTML = oauthTemplate({
          //       access_token: access_token,
          //       refresh_token: refresh_token
          //     });
          //   });
          // }, false);
        }
      })();
    </script>
  

</body>
</div>
</div>
</html>